<!doctype html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ã˜ã‚ƒã‚“ã‘ã‚“</title>

    <!-- CSSèª­ã¿è¾¼ã¿ -->
    <link rel="stylesheet" href="css/style.css" />


</head>

<body>
    <header>
        <h1>ã˜ã‚ƒã‚“ã‘ã‚“</h1>
    </header>

    <main>
        <div class="card">
            <ul class="choices">
                <li id="gu" class="choice-btn">âœŠ ã‚°ãƒ¼</li>
                <li id="choki" class="choice-btn">âœŒï¸ ãƒãƒ§ã‚­</li>
                <li id="pa" class="choice-btn">âœ‹ ãƒ‘ãƒ¼</li>
            </ul>
            <div class="result-area">
                <div>
                    ã‚ãªãŸã®æ‰‹ï¼šã€Œ<span id="user-hand">ã¾ã é¸ã‚“ã§ã„ã¾ã›ã‚“</span>ã€<br>
                    ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®æ‰‹ï¼šã€Œ<span id="pc-hand">ã¾ã é¸ã‚“ã§ã„ã¾ã›ã‚“</span>ã€
                </div>
                <div id="result" class="result">æ‰‹ã‚’é¸ã‚“ã§ãã ã•ã„</div>
            </div>
        </div>
    </main>
    
    <!-- jQueryèª­ã¿è¾¼ã¿ -->
    <script src="js/jquery-3.7.1.min.js"></script>

    <script>
        // ã˜ã‚ƒã‚“ã‘ã‚“ã‚¢ãƒ—ãƒªæ¦‚è¦ -----------------------------------------------
        // 
        // ã€åŸºæœ¬æ©Ÿèƒ½ã€‘
        // - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚°ãƒ¼ãƒ»ãƒãƒ§ã‚­ãƒ»ãƒ‘ãƒ¼ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã§ãã‚‹
        // - ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãŒãƒ©ãƒ³ãƒ€ãƒ ã«æ‰‹ã‚’é¸ã¶
        // - å‹æ•—ã‚’åˆ¤å®šã—ã¦çµæœã‚’è¡¨ç¤ºã™ã‚‹
        // - çµæœã«å¿œã˜ã¦è‰²åˆ†ã‘è¡¨ç¤ºã™ã‚‹
        // 
        // ã€ç”»é¢æ§‹æˆã€‘
        // - #gu ãƒœã‚¿ãƒ³: ã‚°ãƒ¼ã‚’é¸æŠ
        // - #choki ãƒœã‚¿ãƒ³: ãƒãƒ§ã‚­ã‚’é¸æŠ  
        // - #pa ãƒœã‚¿ãƒ³: ãƒ‘ãƒ¼ã‚’é¸æŠ
        // - #pc-hand: ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®æ‰‹ã‚’è¡¨ç¤º
        // - #result: å‹æ•—çµæœã‚’è¡¨ç¤º
        // 
        // ---------------------------------------------------------------

        // ã˜ã‚ƒã‚“ã‘ã‚“ã‚²ãƒ¼ãƒ ã® JavaScript ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ï¼

        $(function () {
            // ----------------------------------------------------
            // ã˜ã‚ƒã‚“ã‘ã‚“ã®ãƒ‡ãƒ¼ã‚¿ã¨ãƒ©ãƒ³ãƒ€ãƒ ãªæ‰‹ã‚’å–å¾—ã™ã‚‹é–¢æ•°ã¯ã€ã‚¹ã‚³ãƒ¼ãƒ—ã‚’åºƒã’ã¦
            // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®å¤–ï¼ˆé–¢æ•°å…¨ä½“ï¼‰ã§å®šç¾©ã—ã¾ã™ã€‚
            // ----------------------------------------------------
            const handsData = {
                "gu": { name: "ã‚°ãƒ¼", emoji: "âœŠ", beats: "choki" },
                "choki": { name: "ãƒãƒ§ã‚­", emoji: "âœŒï¸", beats: "pa" },
                "pa": { name: "ãƒ‘ãƒ¼", emoji: "âœ‹", beats: "gu" }
            };
            const handKeys = Object.keys(handsData); // ["gu", "choki", "pa"]

            /**
             * ãƒ©ãƒ³ãƒ€ãƒ ãªæ‰‹ã‚’é¸æŠã™ã‚‹é–¢æ•°
             * @returns {string} - ãƒ©ãƒ³ãƒ€ãƒ ãªæ‰‹ã®ID (gu, choki, pa)
             */
            function getRandomHandId() {
                const randomIndex = Math.floor(Math.random() * handKeys.length);
                return handKeys[randomIndex];
            }

            /**
             * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰‹ã¨ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®æ‰‹ã‚’æ¯”è¼ƒã—ã€çµæœã‚’è¿”ã™é–¢æ•°
             * @param {string} userHandId - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸ã‚“ã æ‰‹ã®ID (gu, choki, pa)
             * @param {string} computerHandId - ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒé¸ã‚“ã æ‰‹ã®ID
             * @returns {string} - åˆ¤å®šçµæœ ("Win", "Lose", "Draw")
             */
            function judgeJanken(userHandId, computerHandId) {
                if (userHandId === computerHandId) {
                    return "Draw"; // å¼•ãåˆ†ã‘
                }

                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰‹ãŒå‹ã¤ç›¸æ‰‹ã®æ‰‹ã§ã‚ã‚‹ã‹ç¢ºèª (ä¾‹: 'gu' ã® beats ã¯ 'choki')
                if (handsData[userHandId].beats === computerHandId) {
                    return "Win"; // å‹ã¡
                }

                return "Lose"; // è² ã‘
            }

            // ----------------------------------------------------
            // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®å‡¦ç†
            // ----------------------------------------------------

            // 1. ã‚¯ãƒ©ã‚¹å '.choice-btn' ã‚’æŒã¤è¦ç´ ã«ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®šã—ã¾ã™
            $('.choice-btn').on('click', function () {

                // 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é¸æŠã‚’å–å¾—
                const userHandId = $(this).attr('id');
                const userHandName = handsData[userHandId].name;
                const userHandEmoji = handsData[userHandId].emoji;

                // 3. ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®æ‰‹ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«æ±ºå®š
                const computerHandId = getRandomHandId();
                const computerHandName = handsData[computerHandId].name;
                const computerHandEmoji = handsData[computerHandId].emoji;

                // 4. å‹æ•—åˆ¤å®š
                const result = judgeJanken(userHandId, computerHandId);

                let resultMessage = "";
                let resultClass = ""; // çµæœã«ã‚ˆã£ã¦ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰ãˆã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹

                if (result === "Win") {
                    resultMessage = "ğŸ‰ ã‚ãªãŸã®å‹ã¡ï¼ ğŸ‰";
                    resultClass = "win";
                } else if (result === "Lose") {
                    resultMessage = "ğŸ˜­ ã‚ãªãŸã®è² ã‘... ğŸ˜­";
                    resultClass = "lose";
                } else {
                    resultMessage = "ğŸ¤ ã‚ã„ã“ï¼ã‚‚ã†ä¸€å› ğŸ¤";
                    resultClass = "draw";
                }

                // --- 5. çµæœã‚’HTMLã«å‡ºåŠ›ï¼ˆjQueryã‚’ä½¿ç”¨ï¼‰ ---

                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰‹ã‚’æ›´æ–° (ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«: ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸæ‰‹ã‚’ç¢ºèªç”¨ã¨ã—ã¦è¡¨ç¤º)
                $('#user-hand').text(`${userHandEmoji} ${userHandName}`).css('color', 'blue');

                // ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®æ‰‹ã‚’æ›´æ–°
                $('#pc-hand').text(`${computerHandEmoji} ${computerHandName}`).css('color', 'red');

                // çµæœãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æ›´æ–°
                $('#result')
                    .text(resultMessage)
                    .removeClass('win lose draw') // ä»¥å‰ã®ã‚¯ãƒ©ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
                    .addClass(resultClass);        // æ–°ã—ã„ã‚¯ãƒ©ã‚¹ã‚’é©ç”¨

                // å‹•ä½œç¢ºèªã®ãŸã‚ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›
                console.log(`--- ã˜ã‚ƒã‚“ã‘ã‚“é–‹å§‹ ---`);
                console.log(`ã‚ãªãŸã®æ‰‹: ${userHandName}`);
                console.log(`ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®æ‰‹: ${computerHandName}`);
                console.log(`çµæœ: ${result}`);
                console.log(`----------------------`);
            });
        });

    </script>
</body>

</html>